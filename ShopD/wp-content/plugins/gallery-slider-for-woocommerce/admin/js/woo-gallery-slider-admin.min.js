jQuery(document).ready((function($){"use strict";$(document).ready((function(){$(".wcgs-settings").removeClass("wcgs-preloader")})),$(document).on("click",".wcgs-upload-image",(function(e){e.preventDefault();var wcgsAttachment=$(this).parents(".woocommerce_variable_attributes").find(".wcgs-gallery").val();if(""===wcgsAttachment)var wcgsAttachmentArr=[];else var wcgsAttachmentArr=JSON.parse(wcgsAttachment);var variationID=$(this).parents(".woocommerce_variation").find("h3 strong").text(),wcgsGalleryUploader;(wcgsGalleryUploader=wp.media({library:{type:"image"},frame:"post",state:"gallery",multiple:!0})).open(),wcgsGalleryUploader.on("update",(function(selection){selection.models.map((function(attachment){var item=attachment.toJSON();wcgsAttachmentArr.push(attachment.id),2>=wcgsAttachmentArr.length&&$(".wcgs-gallery-items"+variationID).append('<div class="wcgs-image" data-attachmentid="'+item.id+'"><img src="'+item.sizes.thumbnail.url+'" style="max-width:100%;display:inline-block;" /><div class="wcgs-image-remover"><span class="dashicons dashicons-no"></span></div></div>'),$(".wcgs-gallery-items"+variationID).parents(".woocommerce_variable_attributes").find(".wcgs-gallery").val(JSON.stringify(wcgsAttachmentArr)).trigger("change")})),wcgsAttachmentArr.length>0&&($(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-upload-image").hide(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-edit").show(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-remove-all-images").show(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-upload-more-image").show()),wcgsAttachmentArr.length>2&&$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-pro-notice").show()}))})),$(document).on("click",".wcgs-upload-more-image",(function(e){e.preventDefault();var variationID=$(this).parents(".woocommerce_variation").find("h3 strong").text(),wcgsAttachment=$(this).parents(".woocommerce_variable_attributes").find(".wcgs-gallery").val(),wcgsAttachmentArr=JSON.parse(wcgsAttachment);window.wp.media.gallery.edit('[gallery ids="'+wcgsAttachmentArr+'"]').on("update",(function(selection){var wcgsAttachmentArr=[];$(".wcgs-gallery-items"+variationID).empty(),selection.models.map((function(attachment){var item=attachment.toJSON();wcgsAttachmentArr.push(attachment.id),2>=wcgsAttachmentArr.length&&$(".wcgs-gallery-items"+variationID).append('<div class="wcgs-image" data-attachmentid="'+item.id+'"><img src="'+item.sizes.thumbnail.url+'" style="max-width:100%;display:inline-block;" /><div class="wcgs-image-remover"><span class="dashicons dashicons-no"></span></div></div>'),$(".wcgs-gallery-items"+variationID).parents(".woocommerce_variable_attributes").find(".wcgs-gallery").val(JSON.stringify(wcgsAttachmentArr)).trigger("change")})),wcgsAttachmentArr.length>0&&($(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-upload-image").hide(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-edit").show(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-remove-all-images").show(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-upload-more-image").show()),wcgsAttachmentArr.length>2&&$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-pro-notice").show()})),$(document).find(".media-menu-item:contains('Add to Gallery')").click()})),$(document).on("click",".wcgs-remove-all-images",(function(e){e.preventDefault();var variationID=$(this).parents(".woocommerce_variation").find("h3 strong").text();$(".wcgs-gallery-items"+variationID+" .wcgs-image").remove();var wcgsAttachmentArr=[];$(".wcgs-gallery-items"+variationID).parents(".woocommerce_variable_attributes").find(".wcgs-gallery").val(JSON.stringify(wcgsAttachmentArr)).trigger("change"),$(this).hide(),$(this).siblings(".wcgs-upload-more-image").hide(),$(this).siblings(".wcgs-edit").hide(),$(this).siblings(".wcgs-upload-image").show(),$(this).siblings(".wcgs-pro-notice").hide()})),$(document).on("click",".wcgs-image-remover",(function(e){e.preventDefault();var variationID=$(this).parents(".woocommerce_variation").find("h3 strong").text(),attachmentID=$(this).parent(".wcgs-image").data("attachmentid"),wcgsAttachment=$(this).parents(".woocommerce_variable_attributes").find(".wcgs-gallery").val(),wcgsAttachmentArr=JSON.parse(wcgsAttachment),index=wcgsAttachmentArr.indexOf(parseInt(attachmentID));index>-1&&(wcgsAttachmentArr.splice(index,1),$(this).parent(".wcgs-image").remove(),$(".wcgs-gallery-items"+variationID).parents(".woocommerce_variable_attributes").find(".wcgs-gallery").val(JSON.stringify(wcgsAttachmentArr)).trigger("change")),0==wcgsAttachmentArr.length&&($(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-upload-image").show(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-edit").hide(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-remove-all-images").hide(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-upload-more-image").hide()),wcgsAttachmentArr.length>2&&$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-pro-notice").show()})),$(document).on("click",".wcgs-edit",(function(e){e.preventDefault();var variationID=$(this).parents(".woocommerce_variation").find("h3 strong").text(),wcgsAttachment=$(this).parents(".woocommerce_variable_attributes").find(".wcgs-gallery").val(),wcgsAttachmentArr=JSON.parse(wcgsAttachment);window.wp.media.gallery.edit('[gallery ids="'+wcgsAttachmentArr+'"]').on("update",(function(selection){var wcgsAttachmentArr=[];$(".wcgs-gallery-items"+variationID).empty(),selection.models.map((function(attachment){var item=attachment.toJSON();wcgsAttachmentArr.push(attachment.id),2>=wcgsAttachmentArr.length&&$(".wcgs-gallery-items"+variationID).append('<div class="wcgs-image" data-attachmentid="'+item.id+'"><img src="'+item.sizes.thumbnail.url+'" style="max-width:100%;display:inline-block;" /><div class="wcgs-image-remover"><span class="dashicons dashicons-no"></span></div></div>'),$(".wcgs-gallery-items"+variationID).parents(".woocommerce_variable_attributes").find(".wcgs-gallery").val(JSON.stringify(wcgsAttachmentArr)).trigger("change")})),wcgsAttachmentArr.length>0&&($(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-upload-image").hide(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-edit").show(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-remove-all-images").show(),$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-upload-more-image").show()),wcgsAttachmentArr.length>2&&$(".wcgs-gallery-items"+variationID).next("p").find(".wcgs-pro-notice").show()}))})),$(document).on("click",".woocommerce_variation",(function(){var galleryHTML=$(this).find(".wcgs-variation-gallery");$(this).find(".form-row.form-row-full.options").before($(galleryHTML))}))}));